var Y=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var U=(t,s,i)=>s in t?Y(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i,j=(t,s)=>{for(var i in s||(s={}))se.call(s,i)&&U(t,i,s[i]);if(R)for(var i of R(s))ie.call(s,i)&&U(t,i,s[i]);return t},V=(t,s)=>ee(t,te(s));var y=(t,s,i)=>new Promise((r,o)=>{var a=d=>{try{l(i.next(d))}catch(p){o(p)}},h=d=>{try{l(i.throw(d))}catch(p){o(p)}},l=d=>d.done?r(d.value):Promise.resolve(d.value).then(a,h);l((i=i.apply(t,s)).next())});import{_ as E,r as g,o as n,c,a as e,t as _,b as m,d as f,n as M,e as A,f as D,m as T,F as b,g as B,w as H,v as Z,h as oe,i as O,p as ae,j as ne,l as G,u as W,k as N,q as ce,s as le}from"./1703239731943/index-fb3ffbbf.js";import{S as F}from"./1703239731943/SvgIcon-0c7bc192.js";import{V as $,g as re,c as z,m as P,_ as de,a as _e,b as he}from"./1703239731943/PhoneInput.vue_vue_type_script_setup_true_lang-57cde3df.js";import{S as me}from"./1703239731943/sticky-sidebar-292aeeb5.js";import"./1703239731943/component-358970e6.js";function ue(){return y(this,null,function*(){const t=new FormData;return t.append("action","Basket/getBasket"),yield(yield fetch("/local/ajax/",{method:"post",body:t})).json()})}const fe={name:"LocalModal",components:{SvgIcon:F},props:{title:String,isOpen:Boolean,isMini:Boolean,isSide:Boolean,onClose:Function,onAction:Function},data(){return{}}},pe={class:"modal__inner"},ge={key:0,class:"modal__header"},ve={class:"modal__title"},be={class:"modal__main"},ke={class:"modal-has-delete"},Ce=e("div",{class:"modal-has-delete__header"}," Удалить товары? ",-1),ye=e("div",{class:"modal-has-delete__message"},[A(" Хотите удалить товары из вашей корзины? "),e("br"),A(" Отменить действие будет невозможно. ")],-1);function Ie(t,s,i,r,o,a){const h=g("svg-icon");return n(),c("div",{class:M(["modal",{"is-active":i.isOpen,"modal--min":i.isMini,"is-side":i.isSide}])},[e("div",pe,[i.title?(n(),c("div",ge,[e("h3",ve,_(i.title),1),e("button",{type:"button",class:"modal__close",onClick:s[0]||(s[0]=(...l)=>i.onClose&&i.onClose(...l))},[m(h,{name:"close"})])])):f("",!0),e("div",be,[i.title?f("",!0):(n(),c("button",{key:0,type:"button",class:"modal__close",onClick:s[1]||(s[1]=(...l)=>i.onClose&&i.onClose(...l))},[m(h,{name:"close"})])),e("div",ke,[Ce,ye,e("button",{class:"btn btn--whiteText btn--full modal-has-delete__delete",onClick:s[2]||(s[2]=(...l)=>i.onAction&&i.onAction(...l))}," Удалить ")])])])],2)}const we=E(fe,[["render",Ie]]),xe={name:"RelatedItem",components:{SvgIcon:F,VPicture:$},props:{valueItem:{type:Object}},data(){return{}},methods:{},watch:{"value.quantity"(){this.quantity=this.value.quantity}}},Me={class:"min-card-product"},Be={class:"min-card-product__remove"},Oe=D('<div class="min-card-product__image"><picture><source data-srcset="./img/slider-1.webp" type="image/webp"><img class="lazy" data-src="./img/slider-1.jpg" alt=""></picture></div><div class="min-card-product__wrap"><div class="min-card-product__labels"><div class="card-product__label card-product__label--soft"> Мягкий </div><div class="card-product__label card-product__label--middle"> Средний </div></div><div class="min-card-product__title"> Матрас Dianta Optima </div><div class="min-card-product__price"><div class="min-card-product__action">-40%</div><div class="min-card-product__price-current">15 990₽</div><div class="min-card-product__price-old">15 990₽</div></div><div class="min-card-product__size"><b>Размер:</b> 80-190-25см </div></div>',2);function Ee(t,s,i,r,o,a){const h=g("svg-icon");return n(),c("div",Me,[e("div",Be,[m(h,{name:"cross"})]),Oe])}const Fe=E(xe,[["render",Ee]]);function Ae(){return y(this,null,function*(){const t=new FormData;return t.append("action","Basket/clearBasket"),(yield fetch("/local/ajax/",{method:"post",body:t})).status})}const Le={name:"RelatedProducts",components:{SvgIcon:F,RelatedItem:Fe},props:{dataElemenst:Object,sort:{type:Number}},data(){return{sections:[],sectionActiveId:""}},mounted(){var t,s;this.sections=(s=(t=this.dataElemenst)==null?void 0:t.additional)==null?void 0:s.sections},methods:{setActiveSection(t){return y(this,null,function*(){this.sectionActiveId===t?(yield this.getAdditionsItem(),this.modalAdditionsOpen()):this.sectionActiveId=t})},modalAdditionsOpen(){T("additions-list-choices")},getAdditionsItem(){return y(this,null,function*(){if(this.dataElemenst){const t=document.querySelector(".loader_page");t.classList.add("is-active");const s=yield re({sectionId:this.sectionActiveId,selectedOfferMaterial:this.dataElemenst.color&&this.dataElemenst.color.colorId?this.dataElemenst.color.colorId:"",selectedOfferWidth:this.dataElemenst.width?this.dataElemenst.width:"",selectedOfferLength:this.dataElemenst.length?this.dataElemenst.length:"",catalogId:this.dataElemenst.catalogId?this.dataElemenst.catalogId:"",filterElementId:[...this.dataElemenst.additional.itemIds]});s.sort=this.sort+10,localStorage.removeItem("modalAdditionalProps"),localStorage.setItem("modalAdditionalProps",JSON.stringify(s));const i=new CustomEvent("modalAdditionalPropsAdded");return document.dispatchEvent(i),t.classList.remove("is-active"),s}})}},watch:{sectionActiveId(){return y(this,null,function*(){yield this.getAdditionsItem(),this.modalAdditionsOpen()})}}},Se={class:"trade-offers"},$e=e("div",{class:"trade-offers__title"},"Добавьте сопутствующие товары:",-1),Te={class:"trade-offers__list"},Pe=["onClick"],De={class:"trade-offers__add"},ze={class:"trade-offers__name"};function qe(t,s,i,r,o,a){const h=g("svg-icon");return g("related-item"),n(),c("div",Se,[$e,e("div",Te,[(n(!0),c(b,null,B(o.sections,l=>(n(),c("div",{key:l.id,class:"trade-offers__item"},[e("div",{class:"trade-offers__item-row",onClick:d=>a.setActiveSection(l.id)},[e("div",De,[m(h,{name:"pluse"})]),e("div",ze,_(l.name),1)],8,Pe),f("",!0)]))),128))])])}const K=E(Le,[["render",qe]]);function je(t,s,i){return y(this,null,function*(){const r=new FormData;return r.append("action","Basket/changeCount"),r.append("productId",t),r.append("basketItemId",s),r.append("quantity",i),(yield fetch("/local/ajax/",{method:"post",body:r})).status})}const He={name:"VLoaderBlocks"},Ve={class:"loader loader-abs is-active"},Ne=e("div",{class:"loader__circle"},[e("svg",{class:"loader__svg",viewBox:"25 25 50 50"},[e("circle",{class:"loader__path",cx:"50",cy:"50",r:"20",fill:"none","stroke-width":"2"})])],-1),Ze=[Ne];function Re(t,s,i,r,o,a){return n(),c("div",Ve,Ze)}const q=E(He,[["render",Re]]),Ue={name:"FilterMaterial",components:{SvgIcon:F},props:{arColors:{},arMaterial:{},isActive:{type:Boolean,default:!1}},methods:{getActiveColor(){return this.arColors.filter(t=>t.isActive).map(t=>t.id)},getActiveMaterial(){return this.arMaterial.filter(t=>t.isActive).map(t=>t.name)},changeFilter(){this.$emit("changeFilter",{arColor:this.arColors,arMaterial:this.arMaterial,activeColor:this.getActiveColor(),activeMaterial:this.getActiveMaterial()})},resetFilter(){for(let t in this.arColors)this.arColors[t].isActive=!1;for(let t in this.arMaterial)this.arMaterial[t].isActive=!1;this.changeFilter()},close(){this.$emit("close"),this.changeFilter()}}},Je={class:"modal__inner","data-modal-inner":"filters"},Ge={class:"modal__header"},We=e("h3",{class:"modal__title"}," Фильтры ",-1),Ke={class:"filters__content"},Qe={class:"filter-active"},Xe={key:0,class:"filter-active__item"},Ye={key:0,class:"filter-active__item"},et={class:"filter-block js-filter-block","data-type":"color"},tt=e("div",{id:"dropdown-filter-color",class:"filter-block__title filter-block__title--dropdown is-open"}," По цвету ",-1),st={class:"filter-block__content"},it={class:"filter-block__checkbox filter-block__checkbox--margin js-item-input-config"},ot={class:"checkbox checkbox--color"},at=["id","onUpdate:modelValue"],nt=["for"],ct={class:"checkbox__icon"},lt={class:"checkbox__text"},rt={class:"filter-block js-filter-block","data-type":"material"},dt=e("div",{id:"dropdown-filter-material",class:"filter-block__title filter-block__title--dropdown is-open"}," По типу ",-1),_t={class:"filter-block__content"},ht={class:"filter-block__checkbox"},mt={class:"checkbox"},ut=["id","onUpdate:modelValue"],ft=["for"],pt=e("span",{class:"checkbox__icon"},null,-1),gt={class:"checkbox__text"},vt={class:"filters__btn"};function bt(t,s,i,r,o,a){const h=g("svg-icon");return n(),c("div",{"data-modal":"filters",class:M(["modal modal--side",{"is-active":i.isActive}])},[e("div",Je,[e("div",Ge,[We,e("button",{type:"button",class:"modal__close",onClick:s[0]||(s[0]=(...l)=>a.close&&a.close(...l))},[m(h,{name:"close"})])]),e("div",Ke,[e("div",Qe,[(n(!0),c(b,null,B(i.arColors,(l,d)=>(n(),c(b,null,[l.isActive?(n(),c("div",Xe,[A(_(l.name)+" ",1),m(h,{name:"close",onClick:p=>{i.arColors[d].isActive=!1,a.changeFilter()}},null,8,["onClick"])])):f("",!0)],64))),256)),(n(!0),c(b,null,B(i.arMaterial,(l,d)=>(n(),c(b,null,[l.isActive?(n(),c("div",Ye,[A(_(l.name)+" ",1),m(h,{name:"close",onClick:p=>{l.isActive=!1,a.changeFilter()}},null,8,["onClick"])])):f("",!0)],64))),256))]),e("div",et,[tt,e("div",st,[(n(!0),c(b,null,B(i.arColors,(l,d)=>(n(),c("div",it,[e("div",ot,[H(e("input",{id:"filter2-1"+d,"onUpdate:modelValue":p=>l.isActive=p,type:"checkbox",name:"color",class:"checkbox__input",onChange:s[1]||(s[1]=(...p)=>a.changeFilter&&a.changeFilter(...p))},null,40,at),[[Z,l.isActive]]),e("label",{for:"filter2-1"+d,class:"checkbox__label"},[e("span",ct,[e("span",{class:"checkbox__color",style:oe({background:l.code})},null,4)]),e("span",lt,_(l.name),1)],8,nt)])]))),256))])]),e("div",rt,[dt,e("div",_t,[(n(!0),c(b,null,B(i.arMaterial,(l,d)=>(n(),c("div",ht,[e("div",mt,[H(e("input",{id:"filter3-"+d,"onUpdate:modelValue":p=>l.isActive=p,type:"checkbox",class:"checkbox__input",onChange:s[2]||(s[2]=(...p)=>a.changeFilter&&a.changeFilter(...p))},null,40,ut),[[Z,l.isActive]]),e("label",{for:"filter3-"+d,class:"checkbox__label"},[pt,e("span",gt,_(l.name),1)],8,ft)])]))),256))])])]),e("div",vt,[e("button",{class:"btn btn--whiteText",onClick:s[3]||(s[3]=(...l)=>a.close&&a.close(...l))}," Применить "),e("button",{class:"btn btn--stroke",onClick:s[4]||(s[4]=(...l)=>a.resetFilter&&a.resetFilter(...l))}," Сбросить все ")])])],2)}const kt=E(Ue,[["render",bt]]),Ct={name:"MaterialDescr",components:{SvgIcon:F,VPicture:$},props:{title:String,isOpen:Boolean,isMini:Boolean,isSide:Boolean,text:String,pictures:Array,onClose:Function,onAction:Function},data(){return{}}},yt={class:"modal__inner"},It={key:0,class:"modal__header"},wt={class:"modal__title"},xt={class:"modal__main"},Mt={class:"color-description custom-scroll"},Bt={class:"color-description__text"},Ot={key:0,class:"color-description__picture"};function Et(t,s,i,r,o,a){const h=g("svg-icon"),l=g("v-picture");return n(),c("div",{class:M(["modal",{"is-active":i.isOpen,"modal--side":!0}])},[e("div",yt,[i.title?(n(),c("div",It,[e("h3",wt,_(i.title),1),e("button",{type:"button",class:"modal__close",onClick:s[0]||(s[0]=(...d)=>i.onClose&&i.onClose(...d))},[m(h,{name:"close"})])])):f("",!0),e("div",xt,[e("div",Mt,[e("div",Bt,_(i.text),1),i.pictures.length>0?(n(),c("div",Ot,[(n(!0),c(b,null,B(i.pictures,d=>(n(),O(l,{key:d,image:d},null,8,["image"]))),128))])):f("",!0)])])])],2)}const Ft=E(Ct,[["render",Et]]);const At={name:"MaterialOptions",components:{FilterMaterial:kt,VPicture:$,SvgIcon:F,VLoaderBlocks:q,MaterialDescr:Ft},props:{item:{},basketItemId:"",currentOffer:{},materialOpen:{},isCloth:Boolean,loaderShow:{default:!1,type:Boolean}},data(){return{sortByMaterial:!0,showFilter:!1,arFilterColor:[],arFilterMaterial:[],activeMaterial:[],activeColor:[],isOpenMaterial:!1,modalClothOpen:!1,materialContentModal:{name:"",text:"",picture:[]}}},computed:{currentMaterial(){var s;let t={name:"",color:{name:""}};if((s=this.item)!=null&&s.arMaterial)for(let i in this.item.arMaterial)this.item.arMaterial[i].forEach(r=>{r.isActive&&(t.name=i,t.color=r)});return t},arMaterialByColor(){let t={};const s={};for(let i in this.item.arMaterial)this.item.arMaterial[i].forEach(r=>{r.colors&&r.colors.forEach(o=>{var a;s[o]||(s[o]=[]),(this.activeMaterial.length===0||((a=this.activeMaterial)==null?void 0:a.find(h=>h===i))!==void 0)&&s[o].push(r)})});for(let i in this.item.arColors)s[this.item.arColors[i].id].sort((r,o)=>{if(parseInt(r.sort)>parseInt(o.sort))return 1;if(parseInt(r.sort)===parseInt(o.sort))return r.name.localeCompare(o.name,"ru");if(parseInt(r.sort)<parseInt(o.sort))return-1}),s[this.item.arColors[i].id].length>0&&(t[i]={colorId:this.item.arColors[i].id,materials:s[this.item.arColors[i].id]});return t},arMaterialByMaterial(){let t={};for(let s in this.item.arMaterial){let i=!1;t[s]={active:!0,materials:[]},this.item.arMaterial[s]&&this.item.arMaterial[s].forEach((r,o)=>{let a=[];r.colors&&(a=r.colors.filter(h=>{var d;return((d=this.activeColor)==null?void 0:d.find(p=>p===h))!==void 0})),this.activeColor.length===0&&(a==null||a.push("1")),(a==null?void 0:a.length)>0&&(i=!0),(a==null?void 0:a.length)!==0&&t[s].materials.push(this.item.arMaterial[s][o])}),t[s].active=i}return t}},watch:{isOpenMaterial(){this.$refs.dataConfigHead.click()}},mounted(){document.addEventListener(`on-config-material-open-${this.basketItemId}`,()=>{setTimeout(()=>{this.$refs.dataConfigHead.parentElement.classList.contains("is-active")||this.$refs.dataConfigHead.click()},70)})},methods:{toggleModal(t){this.modalClothOpen=!this.modalClothOpen,this.materialContentModal={name:t.name,text:t.description,picture:[t.picture]},this.modalClothOpen},setFilter(){var t;if((t=this.item)!=null&&t.arColors&&this.item.arMaterial&&this.arFilterColor.length===0&&this.arFilterMaterial.length===0){let s=0;for(let r in this.item.arColors)this.arFilterColor[s]={name:this.item.arColors[r].name,id:this.item.arColors[r].id,code:this.item.arColors[r].code,isActive:!1},s++;Object.keys(this.item.arMaterial).forEach(r=>{this.arFilterMaterial.push({name:r,isActive:!1})})}},changeOffer(t){this.currentOffer.id!==t&&this.$emit("changeOffer",t)},setFilters(){this.activeColor=this.$refs.filter.getActiveColor(),this.activeMaterial=this.$refs.filter.getActiveMaterial()},changeFilter(t){this.arFilterColor=t.arColor,this.arFilterMaterial=t.arMaterial,this.activeColor=t.activeColor,this.activeMaterial=t.activeMaterial},closeFilter(){this.showFilter=!1}}},L=t=>(ae("data-v-f3e999ac"),t=t(),ne(),t),Lt={class:"config-item config-item--2 js-config-type-material","data-type":"material","data-config":""},St={ref:"dataConfigHead",class:"config-item__top","data-config-head":""},$t={class:"config-item__icon"},Tt=L(()=>e("div",{class:"config-item__name"}," Материал ",-1)),Pt={class:"config-item__select"},Dt={class:"config-item__select-text","data-config-selected":""},zt={class:"if-open-hide"},qt=L(()=>e("span",{class:"if-open-show"}," Свернуть ",-1)),jt={class:"config-item__select-icon"},Ht={class:"config-item__dropdown","data-config-body":""},Vt={class:"config-item__sort"},Nt={class:"sort-item sort-item--mobile","data-modal-open":"sort"},Zt={class:"sort-item__label"},Rt=L(()=>e("div",{class:"sort-item__name"}," Сортировка ",-1)),Ut={class:"sort-item sort-item--desktop"},Jt={class:"sort-item__label"},Gt=L(()=>e("div",{class:"sort-item__name"}," Сортировка ",-1)),Wt={class:"sort-item__popup"},Kt={class:"sort-list"},Qt={class:"sort-list__item"},Xt={class:"checkbox checkbox--radio"},Yt=["id","name","checked"],es=["for"],ts=L(()=>e("span",{class:"checkbox__icon"},null,-1)),ss=L(()=>e("span",{class:"checkbox__text"},"по типу",-1)),is=[ts,ss],os={class:"sort-list__item"},as={class:"checkbox checkbox--radio"},ns=["id","name","checked"],cs=["for"],ls=L(()=>e("span",{class:"checkbox__icon"},null,-1)),rs=L(()=>e("span",{class:"checkbox__text"},"по цвету",-1)),ds=[ls,rs],_s={class:"sort-item__label"},hs={class:"sort-item__name"},ms={key:0,class:"sort-item__num"},us={key:0,href:"/get_examples/",class:"btn btn--stroke btn--accentText btn--min",target:"_blank"},fs={class:"config-item__wrap"},ps={id:"config-scroll-to",class:"config-item__list"},gs={key:0,class:"config-item__title"},vs={key:1,class:"config-item__grid-color"},bs=["onClick"],ks={class:"checkbox__label"},Cs={class:"checkbox__image"},ys={class:"checkbox__icon"},Is=["onClick"],ws={class:"checkbox__name"},xs={key:0,class:"config-item__title"},Ms={key:1,class:"config-item__grid-color"},Bs=["onClick"],Os={class:"checkbox__label"},Es={class:"checkbox__image"},Fs={class:"checkbox__icon"},As={class:"checkbox__name"};function Ls(t,s,i,r,o,a){const h=g("v-loader-blocks"),l=g("svg-icon"),d=g("v-picture"),p=g("filter-material"),I=g("material-descr");return n(),c(b,null,[e("div",Lt,[i.loaderShow?(n(),O(h,{key:0})):f("",!0),e("div",St,[e("div",$t,[m(l,{name:"material-icon"})]),Tt,e("div",Pt,[e("span",Dt,[e("span",zt,_(a.currentMaterial.color.name),1),qt]),e("span",jt,[m(l,{name:"arrow-bottom"})])])],512),e("div",Ht,[e("div",Vt,[e("div",Nt,[e("div",Zt,[Rt,m(l,{name:"arrow-bottom"})])]),e("div",Ut,[e("div",Jt,[Gt,m(l,{name:"arrow-bottom"})]),e("div",Wt,[e("div",Kt,[e("div",Qt,[e("div",Xt,[e("input",{id:"filter-material"+i.basketItemId,name:"filter"+i.basketItemId,type:"radio",class:"checkbox__input",checked:o.sortByMaterial,onClick:s[0]||(s[0]=k=>o.sortByMaterial=!o.sortByMaterial)},null,8,Yt),e("label",{for:"filter-material"+i.basketItemId,class:"checkbox__label"},is,8,es)])]),e("div",os,[e("div",as,[e("input",{id:"filter-color"+i.basketItemId,name:"filter"+i.basketItemId,type:"radio",class:"checkbox__input",checked:!o.sortByMaterial,onClick:s[1]||(s[1]=k=>o.sortByMaterial=!o.sortByMaterial)},null,8,ns),e("label",{for:"filter-color"+i.basketItemId,class:"checkbox__label"},ds,8,cs)])])])])]),e("div",{class:"sort-item sort-item",onClick:s[2]||(s[2]=k=>o.showFilter=!0)},[e("div",_s,[e("div",hs,[A(" Фильтр "),o.activeColor.length+o.activeMaterial.length>0?(n(),c("span",ms,_(o.activeColor.length+o.activeMaterial.length),1)):f("",!0)])])]),i.isCloth?(n(),c("a",us,"Заказать образцы")):f("",!0)]),e("div",fs,[e("div",ps,[o.sortByMaterial?(n(!0),c(b,{key:0},B(a.arMaterialByMaterial,(k,x)=>{var v,w;return n(),c(b,null,[k.active&&(o.activeMaterial.length===0||((v=o.activeMaterial)==null?void 0:v.find(u=>u===x))!==void 0)?(n(),c("h3",gs,_(x),1)):f("",!0),o.activeMaterial.length===0||((w=o.activeMaterial)==null?void 0:w.find(u=>u===x))!==void 0?(n(),c("div",vs,[(n(!0),c(b,null,B(k.materials,u=>(n(),c(b,null,[u.hidden?f("",!0):(n(),c("div",{key:0,class:M(["checkbox checkbox--color-image",{"checkbox--selected":u.isActive}]),"data-config-item":"",onClick:S=>a.changeOffer(u.offerId)},[e("label",ks,[e("span",Cs,[m(d,{image:u.picture},null,8,["image"]),e("span",ys,[m(l,{name:"checkbox"})]),e("span",{class:"checkbox__question",onClick:S=>a.toggleModal(u)},[e("span",null,[m(l,{name:"search"}),A(" Подробнее ")])],8,Is)]),e("span",ws,_(u.name),1)])],10,bs))],64))),256))])):f("",!0)],64)}),256)):(n(!0),c(b,{key:1},B(a.arMaterialByColor,(k,x)=>{var v,w;return n(),c(b,null,[o.activeColor.length===0||((v=o.activeColor)==null?void 0:v.find(u=>u===k.colorId))!==void 0?(n(),c("h3",xs,_(x),1)):f("",!0),o.activeColor.length===0||((w=o.activeColor)==null?void 0:w.find(u=>u===k.colorId))!==void 0?(n(),c("div",Ms,[(n(!0),c(b,null,B(k.materials,u=>(n(),c("div",{class:M(["checkbox checkbox--color-image",{"checkbox--selected":u.isActive}]),"data-config-item":"",onClick:S=>a.changeOffer(u.offerId)},[e("label",Os,[e("span",Es,[m(d,{image:u.picture},null,8,["image"]),e("span",Fs,[m(l,{name:"checkbox"})])]),e("span",As,_(u.name),1)])],10,Bs))),256))])):f("",!0)],64)}),256))])])])]),m(p,{ref:"filter","is-active":o.showFilter,"ar-colors":o.arFilterColor,"ar-material":o.arFilterMaterial,onChangeFilter:a.changeFilter,onClose:a.closeFilter},null,8,["is-active","ar-colors","ar-material","onChangeFilter","onClose"]),m(I,{title:o.materialContentModal.name,text:o.materialContentModal.text,pictures:o.materialContentModal.picture,"is-open":o.modalClothOpen,"on-close":a.toggleModal},null,8,["title","text","pictures","is-open","on-close"])],64)}const Ss=E(At,[["render",Ls],["__scopeId","data-v-f3e999ac"]]),$s={name:"ConfigOptions",components:{VPicture:$,SvgIcon:F},props:{bases:{type:Object},options:{type:Object},basketItemId:{type:String}},data(){return{arBases:[],arOptions:[],basesName:String,basesHasTransform:!1,dataEmptyOptions:!1}},watch:{bases(){var s,i,r;this.arBases=this.bases,this.arOptions=this.options;const t=(i=(s=this.arBases)==null?void 0:s.listItems)==null?void 0:i.filter(o=>o.isActive);this.basesName=t!==void 0?(r=t[0])==null?void 0:r.name:"",this.dataEmptyOptions=!this.dataEmptyOptions,this.changeBasesHasTransform(),this.changeConfig()},options(){this.arBases=this.bases,this.arOptions=this.options,this.changeConfig()}},mounted(){this.arBases=this.bases,this.arOptions=this.options,document.addEventListener(`on-config-bases-open-${this.basketItemId}`,()=>{setTimeout(()=>{this.$refs.dataConfigHead.parentElement.classList.contains("is-active")||this.$refs.dataConfigHead.click()},70)}),this.changeBasesHasTransform(),this.changeDataEmpty()},methods:{currencyFilter:z,changeConfig(){this.changeBasesHasTransform(),this.changeDataEmpty(),this.basesHasTransform&&this.arOptions.listItems.length>0&&(this.arOptions.listItems=[...this.arOptions.listItems.map(t=>(t.isLiftingDevice&&(t.isActive=!1),t))]),this.$emit("changeConfig",{bases:this.arBases,options:this.arOptions})},changeBases(t){this.arBases.listItems.forEach(s=>s.isActive=!1),this.arBases.listItems[t].isActive=!0,this.basesName=this.arBases.listItems[t].name,this.changeConfig()},changeDataEmpty(){this.dataEmptyOptions=()=>{var t;return this.arOptions&&this.arOptions.listItems&&this.arOptions.listItems.length>0?((t=this.arBases.listItems)==null?void 0:t.filter(s=>!(s.isLiftingDevice&&this.basesHasTransform)).length)<=0:!1},this.dataEmptyOptions=this.dataEmptyOptions()},changeBasesHasTransform(){this.basesHasTransform=()=>{var t;return this.arBases&&this.arBases.listItems&&this.arBases.listItems.length>0?((t=this.arBases.listItems)==null?void 0:t.filter(s=>s.isTransformBases&&s.isActive).length)>0:!1},this.basesHasTransform=this.basesHasTransform()}}},Ts={key:0,class:"config-item config-item--3 js-config-type-bases","data-type":"bases","data-config":""},Ps={ref:"dataConfigHead",class:"config-item__top","data-config-head":""},Ds=D('<div class="config-item__icon"><svg width="28" height="24" viewBox="0 0 28 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.126887 6.67507C0.3431 6.37642 0.760474 6.3096 1.05912 6.52581L16.8638 17.9681C17.0998 18.139 17.4194 18.1371 17.6533 17.9633L26.3053 11.5375C26.6013 11.3176 27.0194 11.3794 27.2392 11.6754C27.4591 11.9714 27.3973 12.3895 27.1014 12.6094L18.4494 19.0352C17.7476 19.5564 16.7889 19.5622 16.0808 19.0496L0.276142 7.6073C-0.0225018 7.39109 -0.0893254 6.97371 0.126887 6.67507Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M0.667624 6.39893C1.03632 6.39893 1.33521 6.69781 1.33521 7.06651L1.3352 10.4044C1.3352 10.7731 1.03632 11.072 0.667623 11.072C0.298928 11.072 4.17705e-05 10.7731 4.17866e-05 10.4044L4.19325e-05 7.06651C4.19486e-05 6.69781 0.298928 6.39893 0.667624 6.39893Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M17.3571 18.4155C17.7258 18.4155 18.0247 18.7144 18.0247 19.0831L18.0247 22.421C18.0247 22.7897 17.7258 23.0886 17.3571 23.0886C16.9884 23.0886 16.6895 22.7897 16.6895 22.421L16.6895 19.0831C16.6895 18.7144 16.9884 18.4155 17.3571 18.4155Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M26.7033 11.7402C27.072 11.7402 27.3708 12.0391 27.3708 12.4078L27.3708 15.7457C27.3708 16.1144 27.072 16.4133 26.7033 16.4133C26.3346 16.4133 26.0357 16.1144 26.0357 15.7457L26.0357 12.4078C26.0357 12.0391 26.3346 11.7402 26.7033 11.7402Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M16.2825 16.5506C16.0577 16.2584 16.1124 15.8393 16.4046 15.6145L24.0249 9.7527C24.3171 9.5279 24.7363 9.58257 24.9611 9.87481C25.1859 10.167 25.1312 10.5862 24.839 10.811L17.2187 16.6727C16.9265 16.8975 16.5073 16.8429 16.2825 16.5506Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M12.2771 13.8812C12.0524 13.589 12.107 13.1698 12.3993 12.945L20.0195 7.08327C20.3118 6.85847 20.7309 6.91314 20.9557 7.20538C21.1805 7.49761 21.1258 7.91675 20.8336 8.14155L13.2133 14.0033C12.9211 14.2281 12.5019 14.1734 12.2771 13.8812Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8.27153 11.2103C8.04674 10.9181 8.10141 10.4989 8.39364 10.2741L16.0139 4.41237C16.3062 4.18757 16.7253 4.24224 16.9501 4.53448C17.1749 4.82671 17.1202 5.24585 16.828 5.47065L9.20771 11.3324C8.91547 11.5572 8.49633 11.5025 8.27153 11.2103Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M4.26616 8.54037C4.04137 8.24814 4.09604 7.829 4.38827 7.6042L12.0085 1.74245C12.3008 1.51765 12.7199 1.57232 12.9447 1.86456C13.1695 2.15679 13.1148 2.57593 12.8226 2.80073L5.20234 8.66248C4.9101 8.88728 4.49096 8.83261 4.26616 8.54037Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.2798 15.2157C14.055 14.9234 14.1097 14.5043 14.4019 14.2795L22.0222 8.41774C22.3145 8.19294 22.7336 8.24761 22.9584 8.53985C23.1832 8.83209 23.1285 9.25122 22.8363 9.47602L15.216 15.3378C14.9238 15.5626 14.5046 15.5079 14.2798 15.2157Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.2742 12.5457C10.0494 12.2535 10.1041 11.8344 10.3963 11.6096L18.0166 5.74782C18.3088 5.52302 18.728 5.57769 18.9528 5.86993C19.1776 6.16216 19.1229 6.5813 18.8307 6.8061L11.2104 12.6679C10.9182 12.8926 10.499 12.838 10.2742 12.5457Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M6.26885 9.87533C6.04405 9.5831 6.09872 9.16396 6.39096 8.93916L14.0112 3.07741C14.3035 2.85261 14.7226 2.90728 14.9474 3.19952C15.1722 3.49175 15.1175 3.91089 14.8253 4.13569L7.20502 9.99744C6.91278 10.2222 6.49365 10.1676 6.26885 9.87533Z" fill="#4B4E51"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M2.26323 7.20492C2.03844 6.91269 2.09311 6.49355 2.38534 6.26875L10.0056 0.406998C10.2979 0.1822 10.717 0.236871 10.9418 0.529107C11.1666 0.821344 11.1119 1.24048 10.8197 1.46528L3.19941 7.32703C2.90717 7.55183 2.48803 7.49716 2.26323 7.20492Z" fill="#4B4E51"></path></svg></div><div class="config-item__name"> Основание </div>',2),zs={class:"config-item__select"},qs={class:"config-item__select-text"},js={class:"if-open-hide"},Hs=e("span",{class:"if-open-show"}," Свернуть ",-1),Vs={class:"config-item__select-icon"},Ns={class:"config-item__dropdown","data-config-body":""},Zs={class:"config-item__wrap"},Rs={class:"config-item__list config-item__list--grid"},Us=["onClick"],Js=["id","checked"],Gs=["for"],Ws={class:"checkbox__image"},Ks=e("span",{class:"checkbox__icon"},null,-1),Qs={class:"checkbox__descr"},Xs={class:"checkbox__descr--text"},Ys={class:"checkbox__descr--prise inline-block"},ei={class:"config-item__top","data-config-head":""},ti=D('<div class="config-item__icon"><svg width="24" height="15" viewBox="0 0 24 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.0195 13.5118C12.9119 13.5118 11.8042 13.5118 10.6919 13.5071C10.5605 13.5071 10.4901 13.54 10.429 13.6714C10.0207 14.5256 9.34017 14.9996 8.38741 14.9996C7.43465 14.9996 6.7541 14.5256 6.34578 13.6714C6.28476 13.54 6.21436 13.5071 6.08295 13.5118C5.36016 13.5165 1.7188 13.5212 0.996012 13.5118C0.465657 13.5071 0.104265 13.0566 0.230987 12.5684C0.320162 12.2352 0.611153 12.0099 0.972545 12.0099C1.70941 12.0052 5.37424 12.0052 6.11111 12.0099C6.22844 12.0099 6.28007 11.9771 6.3317 11.8691C6.73533 11.0055 7.42057 10.5174 8.37802 10.5127C9.34017 10.508 10.0348 10.9961 10.4384 11.8691C10.4901 11.9771 10.5417 12.0099 10.659 12.0099C12.8884 12.0052 20.9643 12.0052 23.1937 12.0099C23.771 12.0099 24.1464 12.5262 23.9399 13.0378C23.8179 13.3429 23.5457 13.5118 23.1702 13.5118C22.0673 13.5118 15.1224 13.5118 14.0195 13.5118ZM9.13366 12.7562C9.13366 12.3385 8.80043 12.0052 8.38741 12.0052C7.97439 12.0052 7.64116 12.3385 7.64116 12.7562C7.64116 13.1739 7.97439 13.5071 8.38741 13.5071C8.80043 13.5071 9.13366 13.1739 9.13366 12.7562Z" fill="#4B4E51"></path><path d="M14.0194 2.99439C12.8977 2.99439 11.7806 2.99439 10.6589 2.9897C10.5416 2.9897 10.49 3.02255 10.4383 3.1305C10.03 4.00347 9.34007 4.4869 8.37323 4.4869C7.41578 4.4822 6.73523 3.99409 6.32691 3.1305C6.27528 3.02255 6.21896 2.9897 6.10632 2.9897C5.36006 2.99439 1.69523 2.99439 0.94898 2.9897C0.582894 2.98501 0.268436 2.72217 0.216809 2.37486C0.160488 2.00878 0.357611 1.65677 0.704923 1.53944C0.812871 1.50189 0.9349 1.4925 1.05223 1.48781C1.76094 1.48312 5.39292 1.48312 6.10632 1.48781C6.22834 1.48781 6.28936 1.45965 6.34099 1.34231C6.74931 0.478727 7.42986 0 8.392 0C9.34477 0 10.0253 0.478727 10.4336 1.33293C10.4947 1.46434 10.5651 1.4925 10.6965 1.4925C12.8883 1.48781 20.9314 1.48781 23.1232 1.4925C23.2499 1.4925 23.3813 1.50658 23.5033 1.54413C23.8553 1.66147 24.0478 2.01347 23.9868 2.38425C23.9304 2.73156 23.6207 2.9897 23.2499 2.99439C22.5271 2.99909 15.9625 2.99439 15.2397 2.99439C14.8314 2.99439 14.423 2.99439 14.0194 2.99439ZM9.13356 2.24345C9.13356 1.82573 8.80033 1.4925 8.38731 1.4925C7.97429 1.4925 7.64106 1.83043 7.64106 2.24345C7.64106 2.66116 7.97429 2.99439 8.38731 2.99439C8.80033 2.99439 9.13356 2.66116 9.13356 2.24345Z" fill="#4B4E51"></path><path d="M9.64498 8.24608C8.53264 8.24608 2.08493 8.25077 0.972592 8.24608C0.41877 8.24139 0.057378 7.72042 0.263888 7.22292C0.381223 6.94131 0.597119 6.77704 0.911578 6.75827C1.01014 6.75358 1.1087 6.75358 1.21196 6.75358C3.36623 6.75358 10.8465 6.75358 13.0008 6.75827C13.1322 6.75827 13.2026 6.72542 13.2636 6.594C13.6672 5.73511 14.3525 5.26108 15.3005 5.25638C16.258 5.25169 16.9432 5.73042 17.3515 6.5987C17.4079 6.71603 17.4642 6.75827 17.5956 6.75827C18.3325 6.74888 22.5132 6.74888 23.25 6.75827C23.7898 6.76296 24.1418 7.28863 23.9447 7.78143C23.832 8.07242 23.5645 8.25077 23.2266 8.25077C22.4944 8.25547 18.3231 8.25547 17.5862 8.25077C17.4689 8.25077 17.4079 8.28363 17.3515 8.39627C16.9432 9.26924 16.2533 9.75266 15.2864 9.74797C14.329 9.74328 13.6484 9.25516 13.2448 8.39158C13.1932 8.28363 13.1416 8.25077 13.0242 8.25077C11.8978 8.25077 10.7714 8.24608 9.64498 8.24608ZM15.3005 6.75358C14.8828 6.75358 14.5543 7.08212 14.5543 7.49983C14.5543 7.91754 14.8828 8.24608 15.3005 8.24608C15.7182 8.24608 16.0468 7.91754 16.0468 7.49983C16.0468 7.07742 15.7182 6.75358 15.3005 6.75358Z" fill="#4B4E51"></path></svg></div><div class="config-item__name"> Опции </div>',2),si={class:"config-item__select"},ii={class:"config-item__select-text"},oi={class:"if-open-hide"},ai=e("span",{class:"if-open-show"}," Свернуть ",-1),ni={class:"config-item__select-icon"},ci={class:"config-item__dropdown","data-config-body":""},li={class:"config-item__wrap"},ri={class:"config-item__list config-item__list--grid"},di={key:0,class:"checkbox checkbox--image","data-config-item":""},_i=["id","onUpdate:modelValue","checked","disabled"],hi=["for"],mi={class:"checkbox__image"},ui=e("span",{class:"checkbox__icon"},null,-1),fi={class:"checkbox__descr"},pi={class:"checkbox__descr--text"},gi={class:"checkbox__descr--prise inline-block"};function vi(t,s,i,r,o,a){const h=g("svg-icon"),l=g("v-picture");return n(),c(b,null,[o.arBases.listItems?(n(),c("div",Ts,[e("div",Ps,[Ds,e("div",zs,[e("span",qs,[e("span",js,_(o.basesName),1),Hs]),e("span",Vs,[m(h,{name:"arrow-bottom"})])])],512),e("div",Ns,[e("div",Zs,[e("div",Rs,[o.arBases.listItems?(n(!0),c(b,{key:0},B(o.arBases.listItems,(d,p)=>(n(),c("div",{class:M(["checkbox checkbox--image checkbox--radio",{"is-active":d.isActive}]),"data-config-item":"",onClick:I=>a.changeBases(p)},[e("input",{id:"option-base-"+p+"-"+i.basketItemId,type:"radio",name:"base",class:"checkbox__input",checked:d.isActive},null,8,Js),e("label",{for:"option-base-"+p+"-"+i.basketItemId,class:"checkbox__label"},[e("span",Ws,[m(l,{image:d.picture},null,8,["image"])]),Ks,e("span",Qs,[e("span",Xs,_(d.name),1),e("span",Ys," + "+_(a.currencyFilter(d.price)),1)])],8,Gs)],10,Us))),256)):f("",!0)])])])])):f("",!0),o.arOptions.listItems&&o.arOptions.listItems.length>0?(n(),c("div",{key:1,class:M(["config-item config-item--4 js-config-type-options",{"d-none":o.dataEmptyOptions}]),"data-type":"options","data-config":""},[e("div",ei,[ti,e("div",si,[e("span",ii,[e("span",oi,_(o.arOptions.count),1),ai]),e("span",ni,[m(h,{name:"arrow-bottom"})])])]),e("div",ci,[e("div",li,[e("div",ri,[(n(!0),c(b,null,B(o.arOptions.listItems,(d,p)=>(n(),c(b,null,[o.basesHasTransform&&d.isLiftingDevice?f("",!0):(n(),c("div",di,[H(e("input",{id:"option-"+p+"-"+i.basketItemId,"onUpdate:modelValue":I=>d.isActive=I,type:"checkbox",class:"checkbox__input",checked:d.isActive,disabled:o.basesHasTransform&&d.isLiftingDevice,onChange:s[0]||(s[0]=(...I)=>a.changeConfig&&a.changeConfig(...I))},null,40,_i),[[Z,d.isActive]]),e("label",{for:"option-"+p+"-"+i.basketItemId,class:"checkbox__label"},[e("span",mi,[m(l,{image:d.picture},null,8,["image"])]),ui,e("span",fi,[e("span",pi,_(d.name),1),e("span",gi," + "+_(a.currencyFilter(d.price)),1)])],8,hi)]))],64))),256))])])])],2)):f("",!0)],64)}const bi=E($s,[["render",vi]]),ki={name:"ProductConfig",components:{ConfigOptions:bi,MaterialOptions:Ss,VPicture:$,SvgIcon:F,VLoaderBlocks:q},props:{config:{type:Object},basketItemId:"",whatOpen:"",whenLoadMaterial:()=>{},whenLoadBases:()=>{},isActive:{type:Boolean,default:!1}},data(){return{currentConfig:{},loaderMaterial:!1,isMaterialCloth:!0,loaderSize:!1,loaderFootings:!1,loaderShow:!0,configInit:!1,itemsConfigLength:4,currentOffer:{price:"",oldPrice:"",discount:"",size:"",id:-1},item:{name:" "},timeoutSize:!1,timeoutMaterial:!1,timeoutFootings:!1,dataType:null}},computed:{currentFoot(){return this.item.arFootings.find(t=>t.isActive).name}},watch:{isActive(){this.currentOffer.id<0&&(this.currentConfig=this.config,this.loadConfig())}},mounted(){},methods:{close(){document.querySelectorAll(".section-config__left").forEach(t=>{t.classList.remove("minimise")}),document.querySelectorAll(".config-item.is-active > .config-item__top").forEach(t=>{t.click()}),this.$emit("close")},setCurrentOffer(){var s,i,r,o,a,h,l,d,p,I,k,x,v,w;const t=(i=(s=this.item)==null?void 0:s.offers)==null?void 0:i.find(u=>u.isActive===!0);t&&(this.currentOffer.price=parseFloat(t.priceNoOptions),this.currentOffer.oldPrice=parseFloat(t.oldPriceNoOptions),this.item.isBed?this.currentOffer.size=t.width+" - "+t.length+" см":+t.height>0?this.currentOffer.size=t.width+" - "+t.length+" - "+t.height+" см":this.currentOffer.size=t.width+" - "+t.length+" см",this.currentOffer.height=t.height,this.currentOffer.id=t.offerId,Array.isArray((a=(o=(r=this.item)==null?void 0:r.arConfig)==null?void 0:o.bases)==null?void 0:a.listItems)&&((d=(l=(h=this.item)==null?void 0:h.arConfig)==null?void 0:l.bases)==null||d.listItems.forEach(u=>{u.isActive&&(this.currentOffer.price+=parseFloat(u.price),this.currentOffer.oldPrice+=parseFloat(u.price))})),Array.isArray((k=(I=(p=this.item)==null?void 0:p.arConfig)==null?void 0:I.options)==null?void 0:k.listItems)&&((w=(v=(x=this.item)==null?void 0:x.arConfig)==null?void 0:v.options)==null||w.listItems.forEach(u=>{u.isActive&&(this.currentOffer.price+=parseFloat(u.price),this.currentOffer.oldPrice+=parseFloat(u.price))})),this.currentOffer.discount=Math.round((this.currentOffer.oldPrice-this.currentOffer.price)/this.currentOffer.oldPrice*100))},currencyFilter(t){return z(t)},changeConfigSize(t){this.timeoutSize=setTimeout(()=>{this.loaderSize=!0},70),this.currentConfig.offerWidth=t.width,this.currentConfig.offerLength=t.length,this.currentConfig.productId=t.offerId,this.loadConfig()},changeFootings(t){this.timeoutFootings=setTimeout(()=>{this.loaderFootings=!0},70),this.currentConfig.productId=t,this.loadConfig()},changeColor(t){this.timeoutMaterial=setTimeout(()=>{this.loaderMaterial=!0},70),this.currentConfig.productId=t,this.loadConfig()},loadConfig(){return y(this,null,function*(){let t=yield P("/local/ajax/",this.currentConfig);for(let s in t.arMaterial)t.arMaterial[s].active=!0,t.arMaterial[s].forEach((i,r)=>{t.arMaterial[s][r]=V(j({},t.arMaterial[s][r]),{hidden:!1})});this.isMaterialCloth=t.showGetExapmples,this.item=t,this.setCurrentOffer(),clearTimeout(this.timeoutSize),clearTimeout(this.timeoutMaterial),clearTimeout(this.timeoutFootings),this.loaderMaterial=!1,this.loaderSize=!1,this.loaderShow=!1,this.loaderFootings=!1,this.$refs.config_material.setFilters(),setTimeout(()=>{this.$refs.config_material.setFilter(),this.configInit||(this.configInit=!0,window.configInit()),this.setActiveConfigItem(),this.$refs.bedPlace.classList.contains("is-active")&&this.$refs.bedPlace.click()},50),setTimeout(()=>{this.configChangeHeight()},150)})},configChangeHeight(){const t=this.$refs.configMain.querySelectorAll("[data-config]:not(.d-none)");t.forEach((s,i)=>{s.classList.remove("config-item--1"),s.classList.remove("config-item--2"),s.classList.remove("config-item--3"),s.classList.remove("config-item--4"),s.classList.remove("config-item--5"),s.classList.remove("config-item--6"),s.classList.add(`config-item--${i+1}`)}),this.itemsConfigLength=t.length},setActiveConfigItem(){const t=document.querySelectorAll("[data-config-body]");let s;if(t.forEach(i=>{i.style.display==="block"&&(s=i)}),s){let i=s.parentElement;for(;!i.classList.contains("config-item");)i=i.parentElement;i.classList.add("is-active")}},changeConfig(t){var o,a,h,l;this.item.arConfig=t;let s,i;Array.isArray((o=t==null?void 0:t.bases)==null?void 0:o.listItems)&&(s=(a=t==null?void 0:t.bases)==null?void 0:a.listItems.find(d=>d.isActive)),Array.isArray((h=t==null?void 0:t.options)==null?void 0:h.listItems)&&(i=(l=t==null?void 0:t.options)==null?void 0:l.listItems.filter(d=>d.isActive));let r={};s!==void 0&&(r.bases=s.offerId),i!==void 0&&(r.options=[],i.forEach(d=>{r.options.push(d.offerId)})),this.currentConfig.config=JSON.stringify(r),this.setCurrentOffer(),setTimeout(()=>{this.configChangeHeight()},150)},changeBasketItem(){const t={mainProduct:this.currentOffer.id,config:this.currentConfig.config};this.$emit("changeBasketItem",t),this.close()}}},Ci={class:"modal__inner","data-modal-inner":"change-config"},yi={class:"section-config custom-scroll"},Ii={ref:"configLeft",class:"section-config__left"},wi={class:"config-item--header-config none md-block"},xi={class:"section-config__title"},Mi={class:"section-config__price"},Bi={class:"section-config__action"},Oi={class:"section-config__current-price"},Ei={class:"section-config__old-price"},Fi={class:"section-config__mobile"},Ai=["href"],Li=["href"],Si={class:"section-config__img"},$i=["href","data-fancybox"],Ti=["href","data-fancybox"],Pi={class:"circle-icon"},Di=["href","data-fancybox"],zi={class:"circle-icon"},qi=e("div",{class:"config-hidden-scroller"},null,-1),ji={class:"section-config__list"},Hi={class:"config-item config-item--header-config md-none"},Vi={class:"section-config__title"},Ni={class:"section-config__price"},Zi={class:"section-config__action"},Ri={class:"section-config__current-price"},Ui={class:"section-config__old-price"},Ji={ref:"bedPlace",class:"config-item config-item--1","data-config":""},Gi={class:"config-item__top","data-config-head":""},Wi=D('<div class="config-item__icon"><svg xmlns="http://www.w3.org/2000/svg" width="39" height="37" viewBox="0 0 39 37" fill="none"><rect x="4" y="1" width="31" height="35" rx="3" stroke="#4B4E51" stroke-width="2"></rect><rect x="7" y="4" width="11" height="6" rx="1" stroke="#4B4E51" stroke-width="2"></rect><rect x="21" y="4" width="11" height="6" rx="1" stroke="#4B4E51" stroke-width="2"></rect><path d="M1 14C1 13.4477 1.44772 13 2 13H36C37.1046 13 38 13.8954 38 15V20.9156C38 21.4998 37.5014 21.9596 36.9192 21.9124L1.91918 19.0745C1.39994 19.0324 1 18.5987 1 18.0778V14Z" fill="#EEF0F1" stroke="#4B4E51" stroke-width="2"></path></svg></div>',1),Ki={class:"config-item__name"},Qi={class:"config-item__select"},Xi={class:"config-item__select-text"},Yi={class:"if-open-hide"},eo=e("span",{class:"if-open-show"}," Свернуть ",-1),to={class:"config-item__select-icon"},so={class:"config-item__dropdown","data-config-body":""},io={class:"config-item__wrap"},oo={class:"config-item__list js-select-sizes-group"},ao={class:"select-size__list"},no={class:"select-size__item select-size__item--head"},co={class:"select-size__row"},lo=e("div",{class:"select-size__col"},[e("div",{class:"select-size__params"},"ширина")],-1),ro=e("div",{class:"select-size__col"},[e("div",{class:"select-size__params"},"длина")],-1),_o={class:"select-size__col"},ho={key:0,class:"select-size__params"},mo={key:1,class:"select-size__params"},uo=["onClick"],fo={class:"select-size__row"},po={class:"select-size__col"},go={class:"select-size__params"},vo={class:"select-size__col"},bo={class:"select-size__params"},ko={key:0,class:"select-size__col no-separator select-size__col--grey"},Co={class:"select-size__params"},yo={key:1,class:"select-size__col"},Io={class:"select-size__params"},wo=e("div",{class:"select-size__bottom-line"},null,-1),xo={class:"select-size__p"},Mo=e("input",{type:"radio",name:"size",hidden:"","data-name":"80 - 190"},null,-1),Bo={key:0,class:"config-item config-item--3","data-type":"bases","data-config":""},Oo={class:"config-item__top","data-config-head":""},Eo=D('<div class="config-item__icon"><svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="13" cy="13" r="12.25" stroke="#4B4E51" stroke-width="1.5"></circle><path d="M24 18.199L14.12 18.1991M25.418 12.6602H12.8541C12.2401 12.6602 11.6864 12.2756 11.4506 11.6854L9.92339 7.86217M9.92339 7.86217C9.66309 7.17304 9.14251 4.98212 6.79989 5.67138C4.45726 6.36064 4.97785 8.65775 5.23814 9.11714L8.36164 16.1316C8.59101 16.7389 9.38632 17.8813 10.8544 18.1441M9.92339 7.86217V1.5M10.8544 18.1441C11.0524 18.1795 11.2625 18.199 11.4851 18.199L14.12 18.1991M10.8544 18.1441L10.2215 20.7655C10.0696 21.3946 10.5463 22.0002 11.1936 22.0002H11.9229C12.3318 22.0002 12.6996 21.7512 12.8514 21.3715L14.12 18.1991" stroke="#4B4E51" stroke-width="1.5"></path></svg></div><div class="config-item__name"> Ножки </div>',2),Fo={class:"config-item__select"},Ao={class:"config-item__select-text"},Lo={class:"if-open-hide"},So=e("span",{class:"if-open-show"}," Свернуть ",-1),$o={class:"config-item__select-icon"},To={class:"config-item__dropdown","data-config-body":""},Po={class:"config-item__wrap"},Do={id:"config-scroll-to",class:"config-item__list"},zo={class:"config-item__grid-color"},qo=["onClick"],jo={class:"checkbox__label"},Ho={class:"checkbox__image"},Vo={class:"checkbox__icon"},No={class:"checkbox__name"},Zo={class:"config-item config-item__btn-ok"},Ro={class:"config-item__top"};function Uo(t,s,i,r,o,a){var k,x,v,w,u,S;const h=g("v-loader-blocks"),l=g("svg-icon"),d=g("v-picture"),p=g("material-options"),I=g("config-options");return n(),c("div",{ref:"configMain",class:M(["modal modal--full modal-change-config",{"is-active":i.isActive}]),"data-modal":"change-config"},[e("div",Ci,[o.loaderShow?(n(),O(h,{key:0})):f("",!0),e("section",yi,[e("div",Ii,[e("div",wi,[e("h3",xi,_(o.item.name),1),e("div",Mi,[e("div",Bi," -"+_(o.currentOffer.discount)+"% ",1),e("div",Oi,_(a.currencyFilter(o.currentOffer.price)),1),e("div",Ei,_(a.currencyFilter(o.currentOffer.oldPrice)),1)]),e("a",{href:"#","data-modal-close":"change-config",class:"section-config__back",onClick:s[0]||(s[0]=(...C)=>a.close&&a.close(...C))},[m(l,{name:"close"})])]),e("div",Fi,[e("a",{href:o.item.originalPicture,"data-fancybox":"img",class:"section-config__mobile-image"},[m(d,{image:o.item.picture},null,8,["image"])],8,Ai),e("a",{href:o.item.originalPicture,"data-fancybox":"img1",class:"circle-icon"},[m(l,{name:"zoom"})],8,Li)]),e("div",Si,[e("a",{ref:"configImage",href:o.item.originalPicture,"data-fancybox":"gallery-"+i.basketItemId},[m(d,{image:o.item.picture},null,8,["image"])],8,$i),e("a",{href:o.item.originalPicture,"data-fancybox":"gallery-"+i.basketItemId+2,class:"section-config__icon md-none"},[e("span",Pi,[m(l,{name:"zoom"})])],8,Ti)]),e("a",{href:o.item.originalPicture,"data-fancybox":"gallery-"+i.basketItemId+1,class:"section-config__icon none md-block"},[e("span",zi,[m(l,{name:"zoom"})])],8,Di),qi],512),e("div",{class:M(["section-config__right custom-scroll",{[`section-config__right-h${o.itemsConfigLength}`]:!0}])},[e("div",ji,[e("div",Hi,[e("h3",Vi,_(o.item.name),1),e("div",Ni,[e("div",Zi," -"+_(o.currentOffer.discount)+"% ",1),e("div",Ri,_(a.currencyFilter(o.currentOffer.price)),1),e("div",Ui,_(a.currencyFilter(o.currentOffer.oldPrice)),1)]),e("a",{href:"#","data-modal-close":"change-config",class:"section-config__back",onClick:s[1]||(s[1]=(...C)=>a.close&&a.close(...C))},[m(l,{name:"close"})])]),e("div",Ji,[o.loaderSize?(n(),O(h,{key:0})):f("",!0),e("div",Gi,[Wi,e("div",Ki,_(o.item.sizeTitle),1),e("div",Qi,[e("span",Xi,[e("span",Yi,_(o.currentOffer.size),1),eo]),e("span",to,[m(l,{name:"arrow-bottom"})])])]),e("div",so,[e("div",io,[e("div",oo,[e("div",ao,[e("label",no,[e("div",co,[lo,ro,e("div",_o,[o.item.isBed?(n(),c("div",ho," габариты кровати ")):o.currentOffer.height?(n(),c("div",mo," высота ")):f("",!0)])])]),(n(!0),c(b,null,B(o.item.offers,C=>(n(),c("label",{class:M(["select-size__item",{active:C.offerId===o.currentOffer.id}]),onClick:X=>a.changeConfigSize(C)},[e("div",fo,[e("div",po,[e("div",go,_(C.width),1)]),e("div",vo,[e("div",bo,_(C.length),1)]),o.item.isBed?(n(),c("div",ko,[e("div",Co," ("+_(C.constructionSize)+" см) ",1)])):C.height?(n(),c("div",yo,[e("div",Io,_(C.height),1)])):f("",!0)]),wo,e("div",xo,_(a.currencyFilter(C.priceNoOptions)),1),Mo],10,uo))),256))])])])])],512),m(p,{ref:"config_material",item:o.item,"material-open":i.whatOpen,"basket-item-id":i.basketItemId,"current-offer":o.currentOffer,"loader-show":o.loaderMaterial,"is-cloth":o.isMaterialCloth,onChangeOffer:a.changeColor},null,8,["item","material-open","basket-item-id","current-offer","loader-show","is-cloth","onChangeOffer"]),o.item.arFootings&&o.item.arFootings.length>0?(n(),c("div",Bo,[o.loaderFootings?(n(),O(h,{key:0})):f("",!0),e("div",Oo,[Eo,e("div",Fo,[e("span",Ao,[e("span",Lo,_(a.currentFoot),1),So]),e("span",$o,[m(l,{name:"arrow-bottom"})])])]),e("div",To,[e("div",Po,[e("div",Do,[e("div",zo,[(n(!0),c(b,null,B(o.item.arFootings,C=>(n(),c("div",{class:M(["checkbox checkbox--color-image",{"checkbox--selected":C.isActive}]),"data-config-item":"",onClick:X=>a.changeFootings(C.offerId)},[e("label",jo,[e("span",Ho,[m(d,{image:C.picture},null,8,["image"]),e("span",Vo,[m(l,{name:"checkbox"})])]),e("span",No,_(C.name),1)])],10,qo))),256))])])])])])):f("",!0),m(I,{"basket-item-id":i.basketItemId,bases:(v=(x=(k=o.item)==null?void 0:k.arConfig)==null?void 0:x.bases)!=null?v:{},options:(S=(u=(w=o.item)==null?void 0:w.arConfig)==null?void 0:u.options)!=null?S:{},onChangeConfig:a.changeConfig,onChangeHeight:a.configChangeHeight},null,8,["basket-item-id","bases","options","onChangeConfig","onChangeHeight"]),e("div",Zo,[e("div",Ro,[e("button",{class:"btn btn--whiteText",onClick:s[2]||(s[2]=(...C)=>a.changeBasketItem&&a.changeBasketItem(...C))}," Выбрать ")])])])],2)])])],2)}const Q=E(ki,[["render",Uo]]),Jo={name:"BasketItem",components:{VLoaderBlocks:q,SvgIcon:F,VPicture:$,RelatedProducts:K,ProductConfig:Q},props:{value:{type:Object},basketUpdate:{type:Function}},data(){return{quantity:Number,isConfigEmpty:!1,dataConfig:{},activeConfig:!1,deleteIsDisabled:!1,loader:{show:!1,timeout:!1},requestTimeout:!1,onConfigOpen:null,whatConfigOpen:""}},watch:{"value.quantity"(){this.quantity=this.value.quantity},activeConfig(){var t,s;this.activeConfig?((t=document.querySelector(".bottom-menu"))==null||t.classList.remove("is-active"),G()):((s=document.querySelector(".bottom-menu"))==null||s.classList.add("is-active"),W())}},mounted(){this.isConfigEmpty=this.value.bases&&this.value.bases!==""||this.value.options,this.quantity=this.value.quantity,this.onConfigMaterialOpen=new CustomEvent(`on-config-material-open-${this.value.basketItemId}`),this.onConfigBasesOpen=new CustomEvent(`on-config-bases-open-${this.value.basketItemId}`)},methods:{whenLoadMaterial(){document.dispatchEvent(this.onConfigMaterialOpen)},whenLoadBases(){document.dispatchEvent(this.onConfigBasesOpen)},whenLoadOptions(){document.dispatchEvent(this.onConfigBasesOpen)},openDefault(){setTimeout(()=>{document.querySelectorAll(".modal-change-config.is-active .config-item[data-type]").forEach(s=>{const i=s.getAttribute("data-type");if(i==="material"&&i===this.whatConfigOpen){s.click();return}if(i==="options"&&i===this.whatConfigOpen){s.click();return}if(i==="bases"&&i===this.whatConfigOpen){s.click();return}})},500)},showConfig(t){this.dataConfig={action:"Basket/getConfig",offerWidth:this.value.props.width,offerLength:this.value.props.length,catalogId:this.value.props.catalogId,productId:this.value.productId,configOpenParams:t,config:JSON.stringify(this.value.config)},this.activeConfig=!0,this.whatConfigOpen=t,this.openDefault()},changeCount(t,s){return y(this,null,function*(){this.deleteIsDisabled=!0,this.quantity=t,clearTimeout(this.requestTimeout),this.requestTimeout=setTimeout(()=>y(this,null,function*(){this.loader.timeout=setTimeout(()=>{this.loader.show=!0},150);const i=yield je(this.value.productId,this.value.basketItemId,t);i===200&&(this.basketUpdate("sidebar"),i.ECOMMERCE&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push(i.ECOMMERCE))),this.loader.show=!1}),900),this.deleteIsDisabled=!1})},hideLoader(){clearTimeout(this.loader.timeout),this.loader.show=!1},changeBasketItem(t){return y(this,null,function*(){var a,h,l,d;this.loader.timeout=setTimeout(()=>{this.loader.show=!0},150);let s={},i={};const r=JSON.parse(t.config);this.value.basketItemId,t.mainProduct!==this.value.productId&&(i={basketItemId:this.value.basketItemId,productId:t.mainProduct}),r&&r.bases&&r.bases!==((h=(a=this.value)==null?void 0:a.bases)==null?void 0:h.productId)&&(s={basketItemId:(d=(l=this.value)==null?void 0:l.bases)==null?void 0:d.basketItemId,productId:r.bases});const o={action:"Basket/changeOfferInBasketItem",main:JSON.stringify(i),bases:JSON.stringify(s),options:r&&r.options?JSON.stringify(r.options):""};yield P("/local/ajax/",o),this.basketUpdate("sidebar"),this.basketUpdate("basketGrid")})},currencyFilter:z,deleteItem(){return y(this,null,function*(){var r,o,a,h;this.loader.timeout=setTimeout(()=>{this.loader.show=!0},150);let t=[];this.value.bases&&t.push({basketItemId:(o=(r=this.value)==null?void 0:r.bases)==null?void 0:o.basketItemId,productId:(h=(a=this.value)==null?void 0:a.bases)==null?void 0:h.productId}),this.value.options&&this.value.options.forEach(l=>{t.push({basketItemId:l.basketItemId,productId:+l.productId})});const s={action:"Basket/changeCount",productId:this.value.productId,basketItemId:this.value.basketItemId,quantity:0,deleteConfig:JSON.stringify(t),type:"remove"},i=yield P("/local/ajax/",s);i.STATUS==="success"&&(this.basketUpdate("sidebar"),i.ECOMMERCE&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push(i.ECOMMERCE))),this.$emit("deleteItem",this.value)})}}},Go=["data-item-id"],Wo={class:"basket-card__content-top"},Ko=["href"],Qo={class:"basket-card__content-top--right"},Xo={class:"basket-card__main-content"},Yo=["href"],ea={class:"basket-card__min-title"},ta={class:"basket-card__size basket-card__text product-size"},sa={class:"product-size__x"},ia={class:"product-size__y"},oa={class:"product-size__z"},aa=e("div",{class:"product-size__measure"}," см. ",-1),na={key:1,class:"basket-card__configs-list"},ca={key:0,class:"basket-card__config basket-card-config basket-card__text"},la=e("div",{class:"basket-card-config__name"}," Цвет: ",-1),ra={class:"basket-card-config__value-list config-values"},da={class:"config-values__value","data-config-type":"material"},_a={key:1,class:"basket-card__config basket-card-config basket-card__text"},ha=e("div",{class:"basket-card-config__name"}," Основание: ",-1),ma={class:"basket-card-config__value-list config-values"},ua={class:"config-values__value"},fa={class:"basket-card-config__prise"},pa={key:2,class:"basket-card__config basket-card-config basket-card__text"},ga=e("div",{class:"basket-card-config__name"}," Опции: ",-1),va={class:"basket-card-config__values config-values"},ba={href:"#",class:"basket-card-config__value"},ka={class:"basket-card-config__prise"},Ca={class:"basket-card__endblock basket-card__endblock--not-deleted basket-endblock"},ya={class:"basket-endblock__quantity product-quantity"},Ia=["disabled"],wa={class:"product-quantity__current-number"},xa={class:"basket-endblock__right"},Ma={class:"product-price"},Ba=e("div",{class:"product-price__text basket-card__text"}," Итого: ",-1),Oa={class:"product-price__price price"},Ea={class:"price__current"},Fa={key:0,class:"price__old"},Aa=["disabled"],La=e("span",{class:"xs-none"}," Удалить товар ",-1),Sa={class:"none xs-block"},$a={key:1,class:"basket-card__trade-offers"};function Ta(t,s,i,r,o,a){var k,x,v,w;const h=g("v-loader-blocks"),l=g("v-picture"),d=g("svg-icon"),p=g("related-products"),I=g("ProductConfig");return n(),c("div",{class:"basket-card","data-item-id":i.value.productId},[o.loader.show?(n(),O(h,{key:0})):f("",!0),e("div",Wo,[e("a",{href:i.value.props.url,class:"basket-card__preview"},[((x=(k=i.value)==null?void 0:k.props)==null?void 0:x.picture)!==null&&i.value.props.picture.hasOwnProperty("*")&&((w=(v=i.value)==null?void 0:v.props)==null?void 0:w.picture["*"].src)!==null?(n(),O(l,{key:0,image:i.value.props.picture},null,8,["image"])):(n(),O(l,{key:1,image:i.value.props.pictureCatalog},null,8,["image"]))],8,Ko),e("div",Qo,[e("div",Xo,[e("a",{href:i.value.props.url,class:"header-in-card"},_(i.value.name),9,Yo),e("h3",ea,_(i.value.props.sizeTitle)+": ",1),e("div",ta,[e("div",sa,_(i.value.props.width),1),A(" - "),e("div",ia,_(i.value.props.length),1),i.value.props.height?(n(),c(b,{key:0},[A(" - "),e("div",oa,_(i.value.props.height),1)],64)):f("",!0),aa]),i.value.props.showConfig?(n(),c("h3",{key:0,class:"basket-card__min-title",onClick:s[0]||(s[0]=(...u)=>a.showConfig&&a.showConfig(...u))},[i.value.props.isBed?(n(),c(b,{key:0},[A(" Конфигурация кровати: ")],64)):(n(),c(b,{key:1},[A(" Конфигурация: ")],64))])):f("",!0),i.value.props.showConfig?(n(),c("div",na,[i.value.props.color?(n(),c("div",ca,[la,e("div",ra,[e("div",da,[e("div",{class:"basket-card-config__value",onClick:s[1]||(s[1]=u=>a.showConfig("material"))},_(i.value.props.color.name),1)])])])):f("",!0),i.value.bases?(n(),c("div",_a,[ha,e("div",ma,[e("div",ua,[e("div",{class:"basket-card-config__value",onClick:s[2]||(s[2]=u=>a.showConfig("bases"))},_(i.value.bases.name),1),e("div",fa," + "+_(a.currencyFilter(i.value.bases.price)),1)])])])):f("",!0),i.value.options?(n(),c("div",pa,[ga,e("div",va,[(n(!0),c(b,null,B(i.value.options,(u,S)=>(n(),c("div",{key:S,class:"config-values__value",onClick:s[3]||(s[3]=C=>a.showConfig("options"))},[e("a",ba,_(u.name),1),e("div",ka," + "+_(a.currencyFilter(u.price)),1)]))),128))])])):f("",!0)])):f("",!0),i.value.props.showConfig?(n(),c("button",{key:2,class:"btn btn--grey basket-card__btn",onClick:s[4]||(s[4]=(...u)=>a.showConfig&&a.showConfig(...u))}," Изменить цвет и конфигурацию ")):f("",!0)]),e("div",Ca,[e("div",ya,[e("button",{class:"product-quantity__btn",title:"Убрать единицу товара",disabled:o.quantity<=1,onClick:s[5]||(s[5]=u=>a.changeCount(o.quantity-1,"remove"))}," - ",8,Ia),e("div",wa,_(o.quantity),1),e("button",{class:"product-quantity__btn",title:"Добавить единицу товара",onClick:s[6]||(s[6]=u=>a.changeCount(o.quantity+1,"add"))}," + ")]),e("div",xa,[e("div",Ma,[Ba,e("div",Oa,[e("span",Ea,_(a.currencyFilter(i.value.finalPrice)),1),i.value.props.oldPrice>i.value.finalPrice?(n(),c("span",Fa,_(a.currencyFilter(i.value.props.oldPrice)),1)):f("",!0)])]),e("button",{class:"link-line basket-endblock__delete",disabled:o.deleteIsDisabled,onClick:s[7]||(s[7]=u=>a.deleteItem())},[La,e("span",Sa,[m(d,{name:"b-trash"})])],8,Aa)])])])]),i.value.props.additional&&i.value.props.additional.sections.length>0?(n(),c("div",$a,[(n(),O(p,{key:i.value.basketItemId,"data-elemenst":i.value.props,sort:+i.value.sort},null,8,["data-elemenst","sort"]))])):f("",!0),m(I,{ref:"configBody","is-active":o.activeConfig,"basket-item-id":i.value.basketItemId,config:o.dataConfig,"when-load-material":a.whenLoadMaterial,"when-load-bases":a.whenLoadBases,"what-open":o.whatConfigOpen,onClose:s[8]||(s[8]=u=>o.activeConfig=!1),onChangeBasketItem:a.changeBasketItem},null,8,["is-active","basket-item-id","config","when-load-material","when-load-bases","what-open","onChangeBasketItem"])],8,Go)}const Pa=E(Jo,[["render",Ta]]),Da={name:"MenuBasket",components:{SvgIcon:F,LocalModal:we},props:{basketUpdate:{type:Function}},data(){return{clearBasketModal:!1}},methods:{clearBasket(){return y(this,null,function*(){(yield Ae())===200&&(this.$emit("clearBasket"),this.clearBasketModal=!1,this.basketUpdate("basketGrid"))})},openShareBasket(){T("share-basket")},toggleModal(){this.clearBasketModal=!this.clearBasketModal;const t=document.querySelector(".bottom-menu");this.clearBasketModal===!0?(t==null||t.classList.remove("is-active"),G()):(t==null||t.classList.add("is-active"),W())}}},za={class:"basket-page__menu menu-basket"},qa={href:"/cabinet/cartpdf/",target:"_blank",class:"menu-basket__item download-pdf"},ja=e("span",{class:"xs-none"},"Сохранить в PDF",-1),Ha={class:"menu-basket__item print",onclick:"window.print()"},Va=e("span",{class:"xs-none"},"Распечатать",-1),Na=e("span",{class:"xs-none"},"Поделиться",-1);function Za(t,s,i,r,o,a){const h=g("svg-icon"),l=g("local-modal");return n(),c(b,null,[e("div",za,[e("a",qa,[m(h,{name:"dl"}),ja]),e("div",Ha,[m(h,{name:"print"}),Va]),e("div",{class:"menu-basket__item share-basket",onClick:s[0]||(s[0]=d=>a.openShareBasket())},[m(h,{name:"b-share"}),Na]),e("button",{class:"menu-basket__item clear-basket link-line",onClick:s[1]||(s[1]=d=>a.toggleModal())}," Очистить корзину ")]),o.clearBasketModal?(n(),O(l,{key:0,"is-open":o.clearBasketModal,"is-mini":!0,"is-side":!1,"on-close":()=>a.toggleModal(),"on-action":()=>{a.clearBasket()}},null,8,["is-open","on-close","on-action"])):f("",!0)],64)}const Ra=E(Da,[["render",Za]]),Ua={name:"DeletedItem",components:{SvgIcon:F,VPicture:$,RelatedProducts:K,ProductConfig:Q,VLoaderBlocks:q},props:{value:{type:Object},basketUpdate:{type:Function}},data(){return{quantity:Number,dataConfig:{},activeConfig:!1,isLoad:!0,loader:{show:!1,timeout:!1}}},mounted(){this.quantity=this.value.quantity,setTimeout(()=>{this.isLoad=!1},50)},methods:{currencyFilter(t){return z(t)},hideLoader(){clearTimeout(this.loader.timeout),this.loader.show=!1},recoverItem(){return y(this,null,function*(){var i,r;this.loader.timeout=setTimeout(()=>{this.loader.show=!0},150);const t={bases:{id:(r=(i=this.value)==null?void 0:i.bases)==null?void 0:r.productId},options:[]};this.value.options&&this.value.options.forEach(o=>{t.options.push({id:o.productId})});const s={action:"Basket/addToBasket",sort:this.value.sort,offerId:this.value.productId,quantity:this.value.quantity,config:JSON.stringify(t)};yield P("/local/ajax/",s),this.$emit("recoverItem")})}}},Ja=["data-item-id"],Ga={class:"basket-card__content-top"},Wa={class:"basket-card__preview"},Ka={class:"basket-card__content-top--right"},Qa={class:"basket-card__main-content"},Xa=e("div",{class:"basket-card__text"},"Вы удалили товар",-1),Ya={class:"header-in-card"},en={class:"basket-card__endblock basket-endblock"},tn={class:"basket-endblock__right"},sn={class:"product-price"},on={class:"product-price__price price"},an={class:"price__current"},nn={class:"price__old"};function cn(t,s,i,r,o,a){var d,p,I,k;const h=g("v-loader-blocks"),l=g("v-picture");return n(),c("div",{class:M(["basket-card basket-card--is-delete",{load:o.isLoad}]),"data-item-id":this.value.productId},[o.loader.show?(n(),O(h,{key:0})):f("",!0),e("div",Ga,[e("div",Wa,[((p=(d=i.value)==null?void 0:d.props)==null?void 0:p.picture)!==null&&i.value.props.picture.hasOwnProperty("*")&&((k=(I=this.value)==null?void 0:I.props)==null?void 0:k.picture["*"].src)!==null?(n(),O(l,{key:0,image:i.value.props.picture},null,8,["image"])):(n(),O(l,{key:1,image:i.value.props.pictureCatalog},null,8,["image"]))]),e("div",Ka,[e("div",Qa,[Xa,e("h2",Ya,_(i.value.name),1)]),e("div",en,[e("button",{class:"btn btn--whiteText",onClick:s[0]||(s[0]=x=>a.recoverItem(o.quantity))},"Восстановить"),e("div",tn,[e("div",sn,[e("div",on,[e("span",an,_(a.currencyFilter(this.value.finalPrice)),1),e("span",nn,_(a.currencyFilter(this.value.props.oldPrice)),1)])])])])])])],10,Ja)}const ln=E(Ua,[["render",cn]]),rn={name:"CartApp",components:{PhoneInput:de,VLoaderBlocks:q,VLoader:_e,DeletedItem:ln,MenuBasket:Ra,BasketItem:Pa,SvgIcon:F},inject:["arParams"],data(){return{hideEmptyMessage:!0,items:[],itemsRef:[],loader:{basketGrid:{show:!0,timeout:!1},sidebar:{show:!0,timeout:!1}},basketItemsDeleted:[],basketItems:[],total:{},isInitSideBar:!1,modalBasketCreatedLinkIsOpen:{isOpen:!0},formPromoCodeVisible:!1,coupon:{value:"",isError:!1,message:"",isApplied:""},phoneForm:{dataIsLoading:!0,phone:"",isValid:!1}}},mounted(){return y(this,null,function*(){this.hideEmptyMessage=!0;let s=new URL(document.location).searchParams.get("basketId");+s>0?yield this.loadBasket(s):yield this.getData(),document.addEventListener("on-basket-update",()=>y(this,null,function*(){yield this.getData()}))})},methods:{changeValid(t){this.phoneForm=j({},t)},placeОrder(t){this.arParams.isAuth||(t.preventDefault(),T("sms-login"))},loadBasket(t){return y(this,null,function*(){yield P("/local/ajax/",{action:"Basket/loadBasket",savedBasketId:t}),yield this.getData(),window.history.pushState({},"",location.origin+location.pathname)})},setItemRef(t){t&&this.itemsRef.push(t)},initSideBar(){window.innerWidth>=1024&&!this.isInitSideBar&&(new me(".vue-sidebar",{topSpacing:20,bottomSpacing:20,containerSelector:!1,innerWrapperSelector:".sidebar",resizeSensor:!0,stickyClass:"is-affixed",minWidth:0}),this.isInitSideBar=!0)},sendSms(){return y(this,null,function*(){T("sms-code",this.phoneForm.phone)})},onSubmit(t){t.preventDefault(),this.phoneForm.isTouch=!0,this.phoneForm.isValid||this.sendSms()},declOfNum(t,s){t=Math.abs(t)%100;var i=t%10;return t>10&&t<20?s[2]:i>1&&i<5?s[1]:i==1?s[0]:s[2]},getData(t=""){return y(this,null,function*(){this.loader[t]&&(this.loader[t].timeout=setTimeout(()=>{this.loader[t].show=!0},100));const s=yield ue();this.basketItems=s.items,s.items.length<=0&&(this.hideEmptyMessage=!1),this.total=s.total,this.initSideBar(),this.setItems(),this.loader[t]&&(clearTimeout(this.loader[t].timeout),this.loader[t].show=!1),this.itemsRef.forEach((i,r)=>{i.hideLoader()}),this.loader.basketGrid.show=!1,this.loader.sidebar.show=!1})},currencyFilter(t){return z(t)},modalOpen(t){T(t)},deleteItem(t){this.basketItemsDeleted.push(V(j({},t),{isDeleted:!0})),this.getData("sidebar")},recoverItem(t){const s=this.basketItemsDeleted.findIndex(i=>i.basketItemId===t);this.basketItemsDeleted.splice(s,1),this.getData("sidebar")},clearBasket(){this.basketItemsDeleted=[],this.loaderTimeout=setTimeout(()=>{this.loaderShow=!0},150)},applyCoupon(t){return y(this,null,function*(){const s=yield he(t);this.coupon.message=s.message,s.status?(yield this.getData(),this.coupon.isError=!1,this.coupon.isApplied=!0):(this.coupon.isApplied=!1,this.coupon.isError=!0)})},setItems(){console.log("11",this.basketItems),this.items=this.basketItems.concat(this.basketItemsDeleted).sort((t,s)=>t.sort<s.sort?-1:t.sort>s.sort?1:0)}}},dn=e("h1",{class:"heading-1"}," Корзина ",-1),_n={class:"basket-page__container md-block"},hn={key:0,class:"save-basket none md-block"},mn=e("h2",{class:"header-in-card"}," Сохранить корзину ",-1),un=e("p",null," Укажите телефон или войдите, чтобы мы сохранили ваши товары. Можно будет вернуться к ним с другого компьютера или телефона. ",-1),fn={class:"input-container"},pn={key:0,class:"error-message"},gn={class:"btn btn-sbm",type:"submit",title:"Отправить"},vn={class:"basket-page__left"},bn={class:"basket-page__list"},kn={class:"vue-sidebar sidebar"},Cn={class:"sidebar__content"},yn={class:"order-detail"},In=e("h2",{class:"header-in-card"}," Детали заказа ",-1),wn={class:"input-container",for:""},xn={key:0,class:"error-message"},Mn={key:1,class:"success-message"},Bn={class:"btn btn-sbm",type:"submit",title:"Отправить"},On={class:"order-options-list"},En={class:"order-option"},Fn={class:"order-option__name"},An=e("span",{class:"order-option__space-dots"},null,-1),Ln={class:"order-option__prise"},Sn={class:"order-option__name"},$n=e("span",{class:"order-option__space-dots"},null,-1),Tn={class:"order-option__prise"},Pn={class:"order-option order-option--result"},Dn=e("div",{class:"order-option__name"}," Итого ",-1),zn=e("span",{class:"order-option__space-dots"},null,-1),qn={class:"order-option__prise"},jn={key:0,class:"save-basket md-none"},Hn=e("h2",{class:"header-in-card"}," Сохранить корзину ",-1),Vn=e("p",null," Укажите телефон или войдите, чтобы мы сохранили ваши товары. Можно будет вернуться к ним с другого компьютера или телефона. ",-1),Nn={class:"input-container"},Zn={class:"btn btn-sbm",type:"submit",title:"Отправить"},Rn=e("h1",{class:"heading-1"}," Корзина пуста ",-1),Un=e("p",null,"Загляните на главную, чтобы выбрать товары или найдите нужное в поиске",-1),Jn=e("a",{href:"/",class:"btn btn--full btn--whiteText"},"Перейти на главную",-1),Gn=[Rn,Un,Jn];function Wn(t,s,i,r,o,a){const h=g("v-loader"),l=g("phone-input"),d=g("svg-icon"),p=g("menu-basket"),I=g("v-loader-blocks"),k=g("deleted-item"),x=g("basket-item");return n(),c(b,null,[m(h),e("div",{class:M(["basket-page",{"visually-hidden":o.basketItems.length<=0&&o.basketItemsDeleted.length<=0}])},[dn,e("div",_n,[a.arParams.isAuth?f("",!0):(n(),c("div",hn,[mn,un,e("form",{class:"form",action:"#",onSubmit:s[0]||(s[0]=N(v=>a.onSubmit(v),["prevent"]))},[e("label",fn,[m(l,{class:M("input"),phone:o.phoneForm.phone},null,8,["phone"]),o.phoneForm.isError?(n(),c("span",pn,_(o.phoneForm.errorMessage),1)):f("",!0)]),e("button",gn,[m(d,{name:"arrow-right"})])],32)])),e("div",vn,[m(p,{"basket-update":a.getData,onClearBasket:a.clearBasket},null,8,["basket-update","onClearBasket"]),e("div",bn,[o.loader.basketGrid.show?(n(),O(I,{key:0})):f("",!0),(n(!0),c(b,null,B(o.items,(v,w)=>(n(),c(b,{key:w},[v.isDeleted?(n(),O(k,{key:0,ref_for:!0,ref:a.setItemRef,value:v,"basket-update":a.getData,onRecoverItem:u=>a.recoverItem(v.basketItemId)},null,8,["value","basket-update","onRecoverItem"])):(n(),O(x,{key:1,ref_for:!0,ref:a.setItemRef,value:v,"basket-update":a.getData,onDeleteItem:a.deleteItem},null,8,["value","basket-update","onDeleteItem"]))],64))),128))])]),e("div",kn,[e("div",Cn,[e("div",yn,[o.loader.sidebar.show?(n(),O(I,{key:0})):f("",!0),In,o.formPromoCodeVisible!==!0?(n(),c("button",{key:1,class:"order-detail__link link-line",onClick:s[1]||(s[1]=v=>o.formPromoCodeVisible=!0)}," У меня есть промокод ")):f("",!0),o.formPromoCodeVisible?(n(),c("form",{key:2,class:"order-detail__form",action:"#",onSubmit:s[3]||(s[3]=N(v=>a.applyCoupon(o.coupon.value),["prevent"]))},[e("label",wn,[H(e("input",{"onUpdate:modelValue":s[2]||(s[2]=v=>o.coupon.value=v),class:M(["input",{error:o.coupon.isError}]),type:"tel",placeholder:"Введете промокод"},null,2),[[ce,o.coupon.value]]),o.coupon.isError?(n(),c("span",xn,_(o.coupon.message),1)):f("",!0),o.coupon.isApplied?(n(),c("span",Mn,_(o.coupon.message),1)):f("",!0)]),e("button",Bn,[m(d,{name:"arrow-right"})])],32)):f("",!0),e("div",On,[e("div",En,[e("div",Fn,_(Object.keys(o.basketItems).length+" "+a.declOfNum(Object.keys(o.basketItems).length,["товар","товара","товаров"])),1),An,e("div",Ln,_(a.currencyFilter(o.total.oldPrice)),1)]),(n(!0),c(b,null,B(o.total.discountList,(v,w)=>(n(),c("div",{key:w,class:"order-option"},[e("div",Sn,_(v.name),1),$n,e("div",Tn," -"+_(a.currencyFilter(v.value)),1)]))),128)),e("div",Pn,[Dn,zn,e("div",qn,_(a.currencyFilter(o.total.finalPrice)),1)])]),e("a",{href:"/cabinet/orders/make/",class:"btn btn-red",onClick:s[4]||(s[4]=v=>a.placeОrder(v))},"Перейти к оформлению")]),a.arParams.isAuth?f("",!0):(n(),c("div",jn,[Hn,Vn,e("form",{class:"form",action:"#",onSubmit:s[5]||(s[5]=N(v=>a.onSubmit(v),["prevent"]))},[e("label",Nn,[m(l,{class:M("input"),"form-data":o.phoneForm,onInputChange:a.changeValid},null,8,["form-data","onInputChange"])]),e("button",Zn,[m(d,{name:"arrow-right"})])],32)]))])])])],2),e("div",{class:M([{"visually-hidden":o.hideEmptyMessage||o.basketItems.length>0||o.basketItemsDeleted.length>0},"basket-is-empty"])},Gn,2)],64)}const Kn=E(rn,[["render",Wn]]),J=le(Kn);window.cart=function(t="#cart",s={}){J.provide("arParams",s),J.mount(t)};
